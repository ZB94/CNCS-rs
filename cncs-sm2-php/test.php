<?php

define("PRIVATE_KEY", "7D2B2391F9633469156F700F8B00D9C85EB6B5327B68684483742EC4AC43043D");
define("PUBLIC_KEY", "FE1FC819D6A8827DB65BF1E114713CE68F116DAA3D6A75A3D8A5E48FAD68C5917F925FA394747EC86613C62EF4FD77E97BD8FF9744453CD4728CFE37F955183A");

var_dump(sm2_sign(PRIVATE_KEY, "TEST", null));
var_dump(sm2_sign(PRIVATE_KEY, "TEST", "1234567812345678"));

assert(sm2_verify(PUBLIC_KEY, "TEST", null, "16262FB1C2887A5634DD47960BFE00AEC52ADD78D6A3762D89F17FE9B7ED93CD11789337D03256B8A79D71ABA80B121E2F832BE196E71CD55D4109E9F6011E32"));
assert(sm2_verify(PUBLIC_KEY, "TEST", "1234567812345678", "7AC28527C6B049FF74C42DE1541DB6BA34FEFE843A65BDAD49292B2830A85100202004346D91D896EF8B363EF42AD787D80F8815FA08FF2C5C204B083DF308F3"));

var_dump(sm2_encrypt(PUBLIC_KEY, "TEST", null));
var_dump(sm2_encrypt(PUBLIC_KEY, "TEST", 1));

assert(sm2_decrypt(PRIVATE_KEY, "BIRtJo5HLttC60UjPZITjhPsNU9H04tWrOXlBLqppWRWRCV+1DnL3GWAnIrRc7/iW7SjHbv4UW6zlRWejcw5kkGhlpVM7y510vyh9MOBat1ssVo4MluxyHuNLawY+OMgetGHJP4=", null) == "TEST");
assert(sm2_decrypt(PRIVATE_KEY, "BPEjTYzruv4ReHl80Jaqu+lHBPNYVZmWwp4zOc1MCbj4LwRcO5Pb/n9V0fs5Aa/4sCOgzEkBq8On2060Spe+x8PuJLhs3kO4Ow0C1pqfTZwD4OIGvcMQgGHyzl5n8+UQA5gknuU=", 1) == "TEST");
